---
title: "analysis.Rmd"
output: html_document
date: "2025-07-23"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r setup, message=FALSE, warning=FALSE}
library(DBI)
library(RSQLite)
install.packages("readxl")
library(readxl)
library(dplyr)
library(ggplot2)

con <- dbConnect(SQLite(), "econ_data.db")
```

```{r import tables}
gdpgrowth_df <- read.csv("datafiles/gdpgrowth.csv", skip = 4)
dbWriteTable(con, "gdp growth", gdpgrowth_df, overwrite = TRUE)

gdpgrowthrate_df <- read.csv("datafiles/gdpgrowthrate.csv", skip = 4)
dbWriteTable(con, "gdp growth rate", gdpgrowthrate_df, overwrite = TRUE)

gdppercapita_df <- read.csv("datafiles/gdppercapita.csv", skip = 4)
dbWriteTable(con, "gdp per capita", gdppercapita_df, overwrite = TRUE)

homeprices_df <- read.csv("datafiles/homeprices.csv")
dbWriteTable(con, "home prices", homeprices_df, overwrite = TRUE)

inflationrate_df <- read.csv("datafiles/inflarate.csv")
dbWriteTable(con, "inflation rate", inflationrate_df, overwrite = TRUE)

inflation_df <- read.csv("datafiles/inflation.csv")
dbWriteTable(con, "inflation", inflation_df, overwrite = TRUE)

unemployedpopulation_df <- read_excel("datafiles/unemppop.xlsx", sheet = 1)
dbWriteTable(con, "unemployed", unemployedpopulation_df, overwrite = TRUE)

unemploymentrate_df <- read_excel("datafiles/uneprate.xlsx", sheet = 1)
dbWriteTable(con, "unemployment rate", unemploymentrate_df, overwrite = TRUE)

workingpopulation_df <- read_excel("datafiles/workpop.xlsx", sheet = 1)
dbWriteTable(con, "working population", workingpopulation_df, overwrite = TRUE)




```

```{r list-tables}
dbListTables(con)

```

```{r list-fields}

dbListFields(con, "gdp growth")
dbListFields(con, "gdp per capita")
dbListFields(con, "gdp growth rate")
dbListFields(con, "home prices")
dbListFields(con, "inflation")
dbListFields(con, "inflation rate")
dbListFields(con, "unemployed")
dbListFields(con, "unemployment rate")
dbListFields(con, "working population")


```
```{r peek-data}

dbGetQuery(con, "SELECT * from \"gdp growth\" LIMIT 10")
dbGetQuery(con, "SELECT * from \"gdp per capita\" LIMIT 10")
dbGetQuery(con, "SELECT * from \"gdp growth rate\" LIMIT 10")

```
